# Pull Request Plan

| PR ID | Title | Scope & Key Files | Acceptance Criteria | Risk / Blast Radius |
| --- | --- | --- | --- | --- |
| S1 | Replace insecure SimHash token hashing | Update `src/utils/dedupe.py` to swap MD5 for a modern hash (e.g., BLAKE2s), adjust any helpers consuming hash output, and refresh unit tests under `tests/test_dedupe_utils.py`.【F:audit/00_inventory.md†L41-L45】 | * Bandit no longer flags MD5 usage; `bandit -ll -r src scripts` passes locally.<br>* Existing dedupe regression tests updated/extended to cover new hashing while preserving similarity thresholds.<br>* Document rationale in `docs/security.md` changelog snippet if required by security policy. | **Medium** — touches deduplication hash logic; limited to utilities/tests but affects pipeline dedupe behavior. Regression could alter clustering; requires targeted validation. |
| T1 | Strengthen scoring regression coverage | Add focused pytest modules (e.g., `tests/scoring/test_basic_scorer.py`) exercising feature toggles and edge cases noted in audit; ensure fixtures cover branches in `src/scoring/basic_scorer.py` and raise module coverage ≥80%.【F:audit/06_test_quality.md†L10-L33】 | * New tests fail against current gaps and pass after implementation.<br>* `pytest --cov=src/scoring` ≥80% and repository total trend documented.<br>* No new flakiness; tests mock external dependencies. | **Low-Medium** — new tests only; runtime untouched, but CI duration slightly increases. |
| D1 | Align CLI/docs guidance with actual tooling | Apply `audit/01_docs_fixes.patch` updates across `README.md` and `docs/faq.md` to reference real modules/config paths and working commands.【F:audit/01_docs_code_diff.md†L10-L24】 | * Updated docs build (`make docs` if available) succeeds with link checker.<br>* README quickstart reflects validated command sequence; FAQ references existing scripts/config modules.<br>* No broken anchors (run link checker). | **Low** — documentation-only; no runtime impact. |
| B1 | Fix `.env.example` compatibility with config loader | Replace legacy keys in `.env.example` with `NOTICIENCIAS__`-prefixed equivalents and extend `noticiencias.config_manager` loaders/tests to confirm precedence from sample env aligns with audit matrix.【F:audit/03_config_matrix.md†L149-L218】 | * `.env.example` variables recognized by config manager without manual translation.<br>* Update or add tests in `tests/test_config_manager.py` verifying environment overrides using new sample keys.<br>* README/config docs mention new prefixes; link to config matrix. | **Medium** — configuration sample change may affect developer setups; ensure migration guidance provided. |
| P1 | Expose canonicalization cache telemetry | Instrument URL canonicalizer to emit cache hit/miss counters (e.g., via structured logging or metrics hooks) and document usage so perf tuning can rely on real telemetry, following audit recommendation.【F:audit/09_perf_findings.md†L27-L34】 | * `src/utils/url_canonicalizer.py` exposes cache statistics API or logging; collectors propagate metrics.<br>* Tests cover cache-hit reporting; perf harness optionally asserts metrics.<br>* Docs (`docs/performance_baselines.md` or README) updated to describe monitoring knob. | **Medium** — touches canonicalization path invoked by collectors; requires regression tests to avoid perf regressions. |
| DX1 | Broaden mypy enforcement for collectors/storage | Expand strict mypy coverage to collector/storage modules by removing `ignore_errors` and fixing surfaced typing issues; update pre-commit/typecheck docs accordingly.【F:audit/12_dx_checklist.md†L15-L27】 | * `mypy` passes with new modules included; CI `make typecheck` unchanged except for broader coverage.<br>* Add/adjust type hints without increasing cyclomatic complexity.<br>* Document stricter coverage in CONTRIBUTING or README. | **Medium** — touches multiple modules; risk of subtle runtime changes if type-driven refactors needed. Mitigate with focused tests. |

## Execution Order
1. S1 (Security)
2. T1 (Tests)
3. D1 (Docs)
4. B1 (Behavior)
5. P1 (Performance)
6. DX1 (Developer Experience)

